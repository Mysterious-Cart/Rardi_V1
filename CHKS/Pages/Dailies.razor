@page "/dailies"

<PageTitle>Daily</PageTitle>

<RadzenStack Orientation="Orientation.Horizontal">
    <RadzenStack Style="width: 80%;">
        <RadzenRow AlignItems="AlignItems.Center" Style="margin-bottom: 25; ">
            <RadzenCard Style="width:100%"  >
                <RadzenStack Orientation = "Orientation.Horizontal" AlignItems = "AlignItems.Center" Gap="20px">
                    <RadzenText Text="Daily Record" TextStyle = "TextStyle.H4" Style="Margin-right:15px"/>
                    <RadzenText Text="Total:" TextStyle="TextStyle.Overline" style="font-size:large"/>
                    <RadzenText Text="@Total" TextStyle = "TextStyle.DisplayH5" Style="Margin-right:15px"/>
      
                    <RadzenText Text="Expense Total:" TextStyle="TextStyle.Overline" style="font-size:large"/>
                    <RadzenText Text="@ExpenseTotal" TextStyle = "TextStyle.DisplayH5" Style="Margin-right:15px"/>                 
                </RadzenStack>
                <RadzenText Text="@dates"/>
            </RadzenCard>
        </RadzenRow>
        

        @if(NoEmptyImport == false)
        {
            <RadzenRow>
                <RadzenStack AlignItems="AlignItems.End" Orientation="Orientation.Horizontal" Style="Width:100%;">
                    <RadzenButton Icon="priority_high" ButtonStyle="ButtonStyle.Danger" style="border-radius:5px" Click="@LoadNotImport"/>
                    <RadzenText Text="Note! There are missing Import Price! Note: Click the Red Exclaimation Mark to view the Missing Data." TextStyle="TextStyle.DisplayH6"/>
                </RadzenStack>
            </RadzenRow>
        }else{
            <RadzenRow>
                <RadzenStack AlignItems="AlignItems.End" Orientation="Orientation.Horizontal" Style="Width:100%;">
                    <RadzenButton Icon="check" ButtonStyle="ButtonStyle.Success" style="border-radius:5px"/>
                    <RadzenText Text="All data are correct. No error detected." TextStyle="TextStyle.DisplayH6"/>
                </RadzenStack>
            </RadzenRow>
        }
        <RadzenRow Style="width: 100%;">
            <RadzenStack Orientation="Orientation.Horizontal">
                <RadzenCard style="height: 100%; width:100%;">
                    <RadzenDataGrid @ref="grid0" ColumnWidth="200px"   AllowFiltering="true" FilterMode="FilterMode.Advanced" style="height:65vh; min-width:fit-content"
                        Data="@History" TItem="CHKS.Models.mydb.History" RowSelect="@OpenHistory">
                        <Columns>
                            <RadzenDataGridColumn TItem="CHKS.Models.mydb.History" Property="CashoutDate" Title="ថ្ងៃទី">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="CHKS.Models.mydb.History" Property="Plate" Title="ផ្លាកលេខ">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="CHKS.Models.mydb.History" Property="Total" Title="សរុប">
                            </RadzenDataGridColumn> 
                        </Columns>
                    </RadzenDataGrid>
                </RadzenCard>
                @if(changeDataMode == true){
                    <RadzenCard Style="width: 50%;">
                        <RadzenDataGrid @ref="grid1" ColumnWidth="100px" AllowFiltering="false" AllowPaging="false" AllowSorting="true" PageSizeOptions=@(new int[]{5, 10, 20, 30})
                            Data="@Historyconnectors" TItem="CHKS.Models.mydb.Historyconnector" GridLines="Radzen.DataGridGridLines.None" >
                            <Columns>
                                <RadzenDataGridColumn TItem="CHKS.Models.mydb.Historyconnector" Property="Product" Title="Name">
                                </RadzenDataGridColumn>
                                <RadzenDataGridColumn TItem="CHKS.Models.mydb.Historyconnector" Property="Qty" Title="Qty">
                                </RadzenDataGridColumn>
                                <RadzenDataGridColumn TItem="CHKS.Models.mydb.Historyconnector" Property="Inventory.Import" Title="Import">
                                    <EditTemplate Context="Historyconnector">
                                        <RadzenNumeric style="display: block; width: 100%" @bind-Value="@Historyconnector.Inventory.Import" Name="Import" />
                                    </EditTemplate>
                                </RadzenDataGridColumn>
                                <RadzenDataGridColumn TItem="CHKS.Models.mydb.Historyconnector" Property="Inventory.Export" Title="Export">
                                    <EditTemplate Context="Historyconnector">
                                        <RadzenNumeric style="display: block; width: 100%" @bind-Value="@Historyconnector.Export" Name="Export" />
                                    </EditTemplate>
                                </RadzenDataGridColumn>
                                <RadzenDataGridColumn>
                                    <EditTemplate Context = "Historyconnector">
                                        <RadzenButton Icon="check" ButtonStyle="ButtonStyle.Success" Variant="Variant.Flat" Size="ButtonSize.Medium"
                                            style="margin-top: 0.25rem; margin-right: 0.25rem; margin-bottom: 0.25rem"
                                            Click=@(args => SaveButtonClick(args, Historyconnector)) @onclick:stopPropagation="true" />
                                        <RadzenButton Icon="close" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium"
                                            Click=@(args => CancelButtonClick(args, Historyconnector)) @onclick:stopPropagation="true" />
                                    </EditTemplate>
                                    <Template Context="Historyconnector">
                                        <RadzenButton Icon="edit" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium"
                                            style="margin-top: 0.25rem; margin-right: 0.25rem; margin-bottom: 0.25rem"
                                            Click=@(args => EditButtonClick(args, Historyconnector)) @onclick:stopPropagation="true" />
                                    </Template>
                                </RadzenDataGridColumn>
                            </Columns>
                        </RadzenDataGrid>
                    </RadzenCard>
                }
            </RadzenStack>
        </RadzenRow>
    </RadzenStack>

    <RadzenCard Style=" width:20%; min-width:fit-content" >
        <RadzenStack>
            <RadzenText Text="List Of Expense:" TextStyle="TextStyle.Overline" TextAlign="TextAlign.Center" style="font-size:x-large; margin-bottom:10px; width:300px"/>
            <RadzenButton Icon="add" Text="Add Expense" Click="@AddBtnClick" style="width:300px" />
            <RadzenDataGrid @ref="grid2" Data="@Dailyexpenses" TItem="Models.mydb.Dailyexpense" RowCreate="@GridCreate" RowUpdate="@GridRowUpdate" style="width:300px">
                <Columns>
                    <RadzenDataGridColumn TItem="Models.mydb.Dailyexpense" Property="Note" Title="Note" Width="90px">
                        <EditTemplate Context="expense">
                            <RadzenTextBox @bind-Value="@expense.Note" />
                        </EditTemplate>
                    </RadzenDataGridColumn>
                    <RadzenDataGridColumn TItem="Models.mydb.Dailyexpense" Property="Expense" Title="Expense">
                        <EditTemplate Context="expense">
                            <RadzenNumeric @bind-Value="@expense.Expense" />
                        </EditTemplate>
                    </RadzenDataGridColumn>
                    <RadzenDataGridColumn>
                        <EditTemplate Context="expense">
                            <RadzenButton Icon="check" ButtonStyle="ButtonStyle.Success" Variant="Variant.Flat" Size="ButtonSize.Medium"
                                style="margin-top: 0.25rem; margin-right: 0.25rem; margin-bottom: 0.25rem"
                                Click=@(args => SaveButtonClick(args, expense)) @onclick:stopPropagation="true" />
                            <RadzenButton Icon="close" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium"
                                Click=@(args => CancelButtonClick(args, expense)) @onclick:stopPropagation="true" />
                        </EditTemplate>
                        <Template Context="expense">

                        <RadzenButton Icon="edit" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium"
                            style="margin-top: 0.25rem; margin-right: 0.25rem; margin-bottom: 0.25rem"
                            Click=@(args => EditButtonClick(args, expense)) @onclick:stopPropagation="true" />

                        <RadzenButton ButtonStyle="ButtonStyle.Danger" Icon="delete" Size="ButtonSize.Medium"
                            Shade="Shade.Lighter" Variant="Variant.Flat"
                            Click=@(args => GridDeleteButtonClick(args, expense)) @onclick:stopPropagation="true" />
                    </Template>
                    </RadzenDataGridColumn>
                </Columns>
            </RadzenDataGrid>
        </RadzenStack>
    </RadzenCard>

</RadzenStack>