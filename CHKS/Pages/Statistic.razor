@page "/statistic"
@attribute [Authorize]

<PageTitle>Statistic</PageTitle>
<RadzenRow>
    <RadzenCard>
        <RadzenStack Orientation = "Orientation.Horizontal" AlignItems = "AlignItems.Center" Gap="20px">
            <RadzenText Text="Monthly Statistic" TextStyle = "TextStyle.H4" Style="Margin-right:15px"/>
            <RadzenText Text="Total:" TextStyle="TextStyle.Overline" style="font-size:large"/>
            <RadzenText Text="@Math.Round(@Total.GetValueOrDefault(),2).ToString()" TextStyle = "TextStyle.DisplayH5" Style="Margin-right:15px"/>
            <RadzenText Text="Product Total:" TextStyle="TextStyle.Overline" style="font-size:large"/>
            <RadzenText Text="@Math.Round(@ProductTotal.GetValueOrDefault(),2).ToString()"  TextStyle = "TextStyle.DisplayH5" Style="Margin-right:15px"/>
            <RadzenText Text="Service Total:" TextStyle="TextStyle.Overline" style="font-size:large"/>
            <RadzenText Text="@Math.Round(@ServiceTotal.GetValueOrDefault(),2).ToString()"  TextStyle = "TextStyle.DisplayH5" Style="Margin-right:15px"/>                
        </RadzenStack>
    </RadzenCard>
</RadzenRow>

<RadzenStack style="margin-top:20px" Orientation="Orientation.Horizontal" Wrap="Radzen.FlexWrap.Wrap">
    <RadzenCard style="Width:fit-content;">
        <RadzenStack style="-width: fit-content; width: 618px; height: fit-content">
            <RadzenStack Orientation="Orientation.Horizontal" Gap="10px" AlignItems="AlignItems.Center"  Style="width: fit-content;">
                <RadzenLabel Text="From" Component="From"/>
                <RadzenDatePicker @bind-Value="@TimeStart" InitialViewDate="@DateTime.Now" Name="From" DateFormat="dd/MM/yyyy" Max="@DateTime.Now" Change="@GetHistoryBaseOfChoosenDate"/>
                <RadzenLabel Text="To" Component="To"/>
                <RadzenDatePicker @bind-Value="@TimeEnd" InitialViewDate="@DateTime.Now" Name="To" DateFormat="dd/MM/yyyy" Max="@DateTime.Now" Change="@GetHistoryBaseOfChoosenDate"/>
            </RadzenStack>

            <RadzenDataGrid AllowFiltering="true" FilterMode="FilterMode.Advanced" AllowPaging="true" AllowSorting="true" @ref="@grid1" TItem ="Models.mydb.History" Data ="@Histories" Style="height: 100%; min-width:600px; width:40%; border-radius:25px;">
                <Columns>
                    <RadzenDataGridColumn title="Date" TItem ="Models.mydb.History" Property="CashoutDate"></RadzenDataGridColumn>
                    <RadzenDataGridColumn title="Plate" TItem ="Models.mydb.History" Property="Plate"></RadzenDataGridColumn>
                    <RadzenDataGridColumn title="Total" TItem ="Models.mydb.History" Property="Total" FormatString="${0:N2}">
                    </RadzenDataGridColumn>

                </Columns>
            </RadzenDataGrid>

        </RadzenStack>
    </RadzenCard>
    <RadzenCard Style="-width: fit-content; width: 235px; height: fit-content;">
        <RadzenDataGrid  AllowFiltering="true" FilterMode="FilterMode.Advanced" AllowPaging="true" AllowSorting="true" @ref="@grid2" TItem ="Models.mydb.Dailyexpense" Data ="@MonthlyExpense" Style="height: 60vh; border-radius:25px;Width:200px;">
            <GroupHeaderTemplate>
                <@context.GroupDescriptor.GetTitle(): @(context.Date)/>
            </GroupHeaderTemplate>
            <Columns>
                <RadzenDataGridColumn title="Note" TItem ="Models.mydb.Dailyexpense" Property="Note"></RadzenDataGridColumn>
                <RadzenDataGridColumn title="Total" TItem ="Models.mydb.Dailyexpense" Property="Total"></RadzenDataGridColumn>
            </Columns>
        </RadzenDataGrid>
    </RadzenCard>
</RadzenStack>


