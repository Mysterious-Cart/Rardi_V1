@page "/statistic"

@attribute [Authorize]

<head>
    <link href="css/Page.css" rel="stylesheet"/>
</head>

<PageTitle>Statistic</PageTitle>

<RadzenStack class="AllPage" Orientation="Orientation.Horizontal">

    <RadzenStack Style="width: 75%">
        <RadzenRow Style="width: fit-content;">
            <RadzenCard Style="background-color: #28282B; border-radius:15px" >
                <RadzenStack Orientation = "Orientation.Horizontal" AlignItems = "AlignItems.Center" Gap="20px" Style="padding: 20px;">
                    <RadzenText Text="ទិន្នន័យប្រចាំខែ" Style="margin-right:15px; font-family:'Khmer OS Battambang'​; font-size:xx-large; color:White"/>
                    <RadzenText Text="សរុប:" style="font-size:x-large; font-family:'Khmer OS Battambang';color:White"/>
                    <RadzenText Text="@Math.Round(@Total.GetValueOrDefault(),2).ToString()" Style="margin-right:15px; font-family:'Khmer OS Battambang';font-size:x-large;color:White"/>
                    <RadzenText Text="សរុបទំនេញ:"  style="font-size:x-large; font-family:'Khmer OS Battambang';color:White "/>
                    <RadzenText Text="@Math.Round(@ProductTotal.GetValueOrDefault(),2).ToString()" Style="margin-right:15px;font-size:x-large; font-family:'Khmer OS Battambang';color:White"/>
                    <RadzenText Text="សរុបសេវា:"  style="font-size:x-large; font-family:'Khmer OS Battambang';color:White"/>
                    <RadzenText Text="@Math.Round(@ServiceTotal.GetValueOrDefault(),2).ToString()"   Style="Margin-right:15px; font-family:'Khmer OS Battambang'; font-size:x-large;color:White"/>                
                </RadzenStack>
            </RadzenCard>
        </RadzenRow>

        <RadzenCard style="Width:100%;">
            <RadzenStack style="width: 50%; height: 74dvh">
                <RadzenStack Orientation="Orientation.Horizontal" Gap="10px" AlignItems="AlignItems.Center">
                    <RadzenLabel Text="From" Component="From"/>
                    <RadzenDatePicker @bind-Value="@TimeStart" InitialViewDate="@DateTime.Now" Name="From" DateFormat="dd/MM/yyyy" Max="@DateTime.Now" Change="@GetHistoryBaseOfChoosenDate"/>
                    <RadzenLabel Text="To" Component="To"/>
                    <RadzenDatePicker @bind-Value="@TimeEnd" InitialViewDate="@DateTime.Now" Name="To" DateFormat="dd/MM/yyyy" Max="@DateTime.Now" Change="@GetHistoryBaseOfChoosenDate"/>
                </RadzenStack>

                <RadzenDataGrid AllowFiltering="true" FilterMode="FilterMode.Advanced" AllowPaging="true" AllowSorting="true" @ref="@grid1" TItem ="Models.mydb.History" Data ="@Histories" Style="height: 100%; min-width:600px; width:100%; border-radius:25px;"
                RowSelect="@OpenHistory">
                    <Columns>
                        <RadzenDataGridColumn title="Date" TItem ="Models.mydb.History" Property="CashoutDate"></RadzenDataGridColumn>
                        <RadzenDataGridColumn title="Plate" TItem ="Models.mydb.History" Property="Plate"></RadzenDataGridColumn>
                        <RadzenDataGridColumn title="Total" TItem ="Models.mydb.History" Property="Total" FormatString="${0:N2}">
                        </RadzenDataGridColumn>

                    </Columns>
                </RadzenDataGrid>

            </RadzenStack>
        </RadzenCard>
            
    </RadzenStack>
    <RadzenCard Style=" width: 25%; height: 90dvh ; margin-right:auto">
        <RadzenDataGrid  AllowFiltering="true" FilterMode="FilterMode.Advanced" AllowPaging="true" AllowSorting="true" @ref="@grid2" TItem ="Models.mydb.Dailyexpense" Data ="@MonthlyExpense" Style="height: 60vh; border-radius:25px;Width:100%;">
            <GroupHeaderTemplate>
                <@context.GroupDescriptor.GetTitle(): @(context.Date)/>
            </GroupHeaderTemplate>
            <Columns>
                <RadzenDataGridColumn title="Note" TItem ="Models.mydb.Dailyexpense" Property="Key"></RadzenDataGridColumn>
                <RadzenDataGridColumn title="Note" TItem ="Models.mydb.Dailyexpense" Property="Note"></RadzenDataGridColumn>
                <RadzenDataGridColumn title="Total" TItem ="Models.mydb.Dailyexpense" Property="Expense"></RadzenDataGridColumn>
            </Columns>
        </RadzenDataGrid>
    </RadzenCard>

</RadzenStack>

